"use strict";
var _SwapConnectorLogger_requestWatermark, _SwapConnectorLogger_baseLogger, _SwapConnectorLogger_swapConnector, _SwapConnectorLogger_context, _SwapConnectorLogger_maskCredentialFunction;
Object.defineProperty(exports, "__esModule", { value: true });
exports.SwapConnectorLogger = void 0;
const tslib_1 = require("tslib");
const crypto_1 = require("crypto");
const logger_1 = require("../common/logger");
class SwapConnectorLogger extends logger_1.Logger {
    constructor(baseLogger, swapConnector, maskCredentialFunction) {
        super();
        _SwapConnectorLogger_requestWatermark.set(this, (0, crypto_1.randomBytes)(16).toString("hex"));
        _SwapConnectorLogger_baseLogger.set(this, void 0);
        _SwapConnectorLogger_swapConnector.set(this, void 0);
        _SwapConnectorLogger_context.set(this, void 0);
        _SwapConnectorLogger_maskCredentialFunction.set(this, void 0);
        tslib_1.__classPrivateFieldSet(this, _SwapConnectorLogger_baseLogger, baseLogger, "f");
        tslib_1.__classPrivateFieldSet(this, _SwapConnectorLogger_swapConnector, swapConnector, "f");
        tslib_1.__classPrivateFieldSet(this, _SwapConnectorLogger_context, `[${tslib_1.__classPrivateFieldGet(this, _SwapConnectorLogger_swapConnector, "f")} requestWatermark ${tslib_1.__classPrivateFieldGet(this, _SwapConnectorLogger_requestWatermark, "f")}]`, "f");
        tslib_1.__classPrivateFieldSet(this, _SwapConnectorLogger_maskCredentialFunction, maskCredentialFunction, "f");
    }
    message(level, ...params) {
        if (params[0] && typeof params[0] === "object" && typeof params[1] === "string") {
            // eslint-disable-next-line @typescript-eslint/no-explicit-any
            const ctx = params[0];
            Object.keys(ctx).forEach(
            // eslint-disable-next-line @typescript-eslint/no-unsafe-argument
            (key) => (ctx[key] = typeof ctx[key] === "string" ? tslib_1.__classPrivateFieldGet(this, _SwapConnectorLogger_maskCredentialFunction, "f").call(this, ctx[key]) : ctx[key]));
            tslib_1.__classPrivateFieldGet(this, _SwapConnectorLogger_baseLogger, "f")[level](ctx, `${tslib_1.__classPrivateFieldGet(this, _SwapConnectorLogger_context, "f")} ${tslib_1.__classPrivateFieldGet(this, _SwapConnectorLogger_maskCredentialFunction, "f").call(this, params[1])}`);
        }
        else {
            const ctx = params.map(tslib_1.__classPrivateFieldGet(this, _SwapConnectorLogger_maskCredentialFunction, "f"));
            tslib_1.__classPrivateFieldGet(this, _SwapConnectorLogger_baseLogger, "f")[level](`${tslib_1.__classPrivateFieldGet(this, _SwapConnectorLogger_context, "f")}`, ...ctx);
        }
    }
    /**
     * @param params any arrays or (object, string) for structured log
     * @returns void
     */
    verbose(...params) {
        return this.message("verbose", ...params);
    }
    /**
     * @param params any arrays or (object, string) for structured log
     * @returns void
     */
    log(...params) {
        return this.message("log", ...params);
    }
    /**
     * @param params any arrays or (object, string) for structured log
     * @returns void
     */
    error(...params) {
        return this.message("error", ...params);
    }
}
exports.SwapConnectorLogger = SwapConnectorLogger;
_SwapConnectorLogger_requestWatermark = new WeakMap(), _SwapConnectorLogger_baseLogger = new WeakMap(), _SwapConnectorLogger_swapConnector = new WeakMap(), _SwapConnectorLogger_context = new WeakMap(), _SwapConnectorLogger_maskCredentialFunction = new WeakMap();
//# sourceMappingURL=swap-connector.logger.js.map